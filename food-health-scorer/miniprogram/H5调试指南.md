# 食品健康评分小程序 - H5调试指南

本文档提供在HBuilder中运行项目到H5平台（Chrome浏览器）时可能遇到的白屏问题的解决方案。

## 白屏问题解决方案

如果在HBuilder中运行到Chrome浏览器时出现白屏，请按照以下步骤排查和解决：

### 1. 检查浏览器控制台错误

1. 在Chrome浏览器中按下 `F12` 或右键点击页面选择"检查"打开开发者工具
2. 切换到"控制台"(Console)标签页
3. 查看是否有红色错误信息，这些错误通常会指出问题所在

### 2. 检查入口文件路径

确保 `index.html` 中的脚本引用路径正确：

```html
<!-- 使用相对路径而非绝对路径 -->
<script type="module" src="./main.js"></script>
```

### 3. 检查路径别名配置

确保 `vite.config.js` 中的路径别名配置正确：

```js
resolve: {
  alias: {
    '@': resolve(__dirname, './') // 指向项目根目录而非 './src'
  }
}
```

### 4. 使用调试工具

我们已经添加了全局错误捕获和调试信息输出，可以帮助您诊断问题：

- 在 `App.vue` 中的 `onLaunch` 和 `initApp` 方法会输出环境信息
- 在 `main.js` 中添加了全局错误处理
- 在 `index.html` 中添加了页面加载状态检测

### 5. 使用备用UI组件

如果应用加载失败，会显示 `FallbackError` 组件，它会提供错误信息和调试数据，帮助您确定问题所在。

### 6. 常见问题及解决方法

#### 路径问题

- **问题**: 资源路径错误导致无法加载JS或CSS文件
- **解决**: 使用相对路径 `./` 而非绝对路径 `/`

#### 环境变量问题

- **问题**: `process.env.UNI_PLATFORM` 在某些环境下可能未定义
- **解决**: 使用条件编译 `// #ifdef H5` 和 `// #endif` 包裹特定平台代码

#### Vue挂载问题

- **问题**: Vue应用未正确挂载到DOM
- **解决**: 确保 `createApp()` 函数正确返回app实例，并且DOM中存在id为"app"的元素

#### 跨域问题

- **问题**: API请求跨域导致应用无法获取数据
- **解决**: 在 `manifest.json` 中配置代理或在后端添加CORS支持

### 7. 重新构建项目

有时候清除缓存并重新构建项目可以解决一些难以定位的问题：

```bash
# 进入项目目录
cd /Users/macbookpro/AI创业/food-health-scorer/miniprogram

# 清除缓存并重新构建
rm -rf node_modules/.cache
rm -rf unpackage/dist
npm run dev:h5
```

## 使用Chrome开发者工具调试

Chrome开发者工具提供了强大的调试功能：

1. **Elements面板**: 检查DOM结构，确认Vue组件是否正确渲染
2. **Console面板**: 查看日志输出和错误信息
3. **Network面板**: 监控网络请求，检查资源是否正确加载
4. **Sources面板**: 设置断点调试JavaScript代码
5. **Application面板**: 检查localStorage、sessionStorage等存储内容

## 联系支持

如果您尝试了上述所有方法仍然无法解决问题，请联系开发团队提供以下信息：

1. 错误截图（包含控制台错误信息）
2. HBuilderX版本号
3. Chrome浏览器版本
4. 操作系统版本
5. 项目运行命令
